<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PVCAM: Post-Processing Parameters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="PM_logo_html.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PVCAM
   &#160;<span id="projectnumber">3.10.x</span>
   </div>
   <div id="projectbrief">Programmable Virtual Camera Access Method library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_ex__post_processing_parameters.xhtml','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Post-Processing Parameters </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This sample demonstrates usage of post-processing features and parameters. It shows how to access the post-processing features of a camera without hard-coding values, independently of which camera is detected and used.</p>
<p>Every camera may support different set of post-processing 'features'. Features are groups which group one or more 'parameters'. These 'parameters' are similar to regular PVCAM parameters, but they need to be discovered by the application at run-time. The 'parameters' are currently limited to <code>uns32</code> data type.</p>
<p>The application will usually build a tree similar to the following one:</p><ul>
<li>Feature: "B.E.R.T" (<a class="el" href="group__grp__pm__parameters.xhtml#gae1127ec5c81c0bb775be2b2e406e5b1d" title="This selects the current post-processing feature from a table of available choices. ">PARAM_PP_INDEX</a>=0)<ul>
<li>Parameter: "ENABLED" (<a class="el" href="group__grp__pm__parameters.xhtml#gadefc71129faca3766fa39b0e68bcf7c8" title="This selects the current post-processing parameter from a table of available choices. ">PARAM_PP_PARAM_INDEX</a>=0)</li>
<li>Parameter: "Threshold" (<a class="el" href="group__grp__pm__parameters.xhtml#gadefc71129faca3766fa39b0e68bcf7c8" title="This selects the current post-processing parameter from a table of available choices. ">PARAM_PP_PARAM_INDEX</a>=1)</li>
</ul>
</li>
<li>Feature: "DENOISING" (<a class="el" href="group__grp__pm__parameters.xhtml#gae1127ec5c81c0bb775be2b2e406e5b1d" title="This selects the current post-processing feature from a table of available choices. ">PARAM_PP_INDEX</a>=1)<ul>
<li>Parameter: "ENABLED" (<a class="el" href="group__grp__pm__parameters.xhtml#gadefc71129faca3766fa39b0e68bcf7c8" title="This selects the current post-processing parameter from a table of available choices. ">PARAM_PP_PARAM_INDEX</a>=0)</li>
<li>Parameter: "Number of iterations" (<a class="el" href="group__grp__pm__parameters.xhtml#gadefc71129faca3766fa39b0e68bcf7c8" title="This selects the current post-processing parameter from a table of available choices. ">PARAM_PP_PARAM_INDEX</a>=1)</li>
<li>Parameter: "Sigma" (<a class="el" href="group__grp__pm__parameters.xhtml#gadefc71129faca3766fa39b0e68bcf7c8" title="This selects the current post-processing parameter from a table of available choices. ">PARAM_PP_PARAM_INDEX</a>=2)</li>
</ul>
</li>
</ul>
<p>Because the indexes and their order may be different for every camera, the PVCAM also provides a <a class="el" href="group__grp__pm__parameters.xhtml#ga939def6cf993a0a272176dbf2c646e94" title="This returns the ID of the currently-selected post-processing feature. ">PARAM_PP_FEAT_ID</a> and <a class="el" href="group__grp__pm__parameters.xhtml#gaa550f7102be94c6d56f97d41fd5651db" title="This returns the ID of the currently selected post-processing parameter. ">PARAM_PP_PARAM_ID</a> parameters. These IDs are uniquely defined in <a class="el" href="pvcam_8h.xhtml">pvcam.h</a> and they are assigned to a particular feature/parameter.</p>
<p>If the application needs to programmatically control a particular PP parameter, it should use the ID to find to corresponding indexes first and then set the indexes to PVCAM and control the parameter state via <a class="el" href="group__grp__pm__parameters.xhtml#gaf9380c3481ef2fb3e3f4c8a31eba5a24" title="This gets or sets the post-processing parameter for the currently selected post-processing parameter ...">PARAM_PP_PARAM</a> parameter.</p>
<p>The code snippet below initializes PVCAM and opens the first available camera. Please refer to the actual code sample in the SDK installation directory for more details about the common helper functions used in this documentation. </p><div class="fragment"><div class="line">std::vector&lt;CameraContext*&gt; contexts;</div><div class="line"><span class="keywordflow">if</span> (!InitAndOpenOneCamera(contexts, cSingleCamIndex))</div><div class="line">    <span class="keywordflow">return</span> APP_EXIT_ERROR;</div><div class="line">CameraContext* ctx = contexts[cSingleCamIndex];</div></div><!-- fragment --><p>Check if the camera supports post-processing parameters: </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (!IsParamAvailable(ctx-&gt;hcam, <a class="code" href="group__grp__pm__parameters.xhtml#gae1127ec5c81c0bb775be2b2e406e5b1d">PARAM_PP_INDEX</a>, <span class="stringliteral">&quot;PARAM_PP_INDEX&quot;</span>))</div><div class="line">{</div><div class="line">    CloseAllCamerasAndUninit(contexts);</div><div class="line">    <span class="keywordflow">return</span> APP_EXIT_ERROR;</div><div class="line">}</div></div><!-- fragment --><p>Detect all available post-processing features using the <a class="el" href="_ex__common_functions.xhtml#DiscoverCameraPostProcessing">DiscoverCameraPostProcessing</a> helper function and display them in a tree structure: </p><div class="fragment"><div class="line"><span class="keyword">const</span> std::vector&lt;PvcamPpFeature&gt; ppFeatures = DiscoverCameraPostProcessing(ctx);</div><div class="line"></div><div class="line">printf(<span class="stringliteral">&quot;Camera Post-Processing tree:\n&quot;</span>);</div><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> PvcamPpFeature&amp; ppFeature : ppFeatures)</div><div class="line">{</div><div class="line">    <span class="comment">// Print IDs as signed integers to display invalid value as -1 instead of a large number.</span></div><div class="line">    <span class="comment">// Valid ID is usually a small number based on current pattern in pvcam.h.</span></div><div class="line">    printf(<span class="stringliteral">&quot;- FEATURE at index %d: id=%d, name=&#39;%s&#39;\n&quot;</span>,</div><div class="line">            ppFeature.index, (<a class="code" href="master_8h.xhtml#a56f1a81c92849566ae864511088eb7e8">int32</a>)ppFeature.id, ppFeature.name.c_str());</div><div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> PvcamPpParameter&amp; ppParam : ppFeature.parameterList)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;  - PARAMETER at index %d: id=%d, name=&#39;%s&#39;\n&quot;</span>,</div><div class="line">                ppParam.index, (<a class="code" href="master_8h.xhtml#a56f1a81c92849566ae864511088eb7e8">int32</a>)ppParam.id, ppParam.name.c_str());</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>Build a selection list for the post-processing features and display it in the console as an interactive menu. </p><div class="fragment"><div class="line">NVPC menuPpFeatures;</div><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> PvcamPpFeature&amp; ppFeature : ppFeatures)</div><div class="line">{</div><div class="line">    NVP nvpFeature;</div><div class="line">    nvpFeature.value = ppFeature.index; <span class="comment">// Post-Processing Feature selection</span></div><div class="line">    nvpFeature.name = ppFeature.name;</div><div class="line">    menuPpFeatures.push_back(nvpFeature);</div><div class="line">}</div><div class="line"><span class="keywordflow">if</span> (!GetMenuSelection(<span class="stringliteral">&quot;Choose Post-Processing Feature&quot;</span>,</div><div class="line">            menuPpFeatures, menuSelection))</div><div class="line">{</div><div class="line">    printf(<span class="stringliteral">&quot;No valid Feature selected, exiting...\n&quot;</span>);</div><div class="line">    CloseAllCamerasAndUninit(contexts);</div><div class="line">    <span class="keywordflow">return</span> 0; <span class="comment">// Not an error, exit the app</span></div><div class="line">}</div><div class="line"><span class="keyword">const</span> PvcamPpFeature&amp; ppFeature = ppFeatures[menuSelection];</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Please, refer to the <a class="el" href="_ex__common_functions.xhtml#GetMenuSelection">GetMenuSelection</a> section.</dd></dl>
<p>Allow the user to interact with the PP features' parameters as long as valid input is entered. </p><div class="fragment"><div class="line">NVPC menuPpParams;</div><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> PvcamPpParameter&amp; ppParam : ppFeature.parameterList)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (!GetPpParamValue(ctx, ppFeature.index, ppParam.index, curValue))</div><div class="line">    {</div><div class="line">        CloseAllCamerasAndUninit(contexts);</div><div class="line">        <span class="keywordflow">return</span> APP_EXIT_ERROR;</div><div class="line">    }</div><div class="line">    NVP nvpParam;</div><div class="line">    nvpParam.value = ppParam.index; <span class="comment">// Post-Processing Parameter selection</span></div><div class="line">    nvpParam.name = ppParam.name + <span class="stringliteral">&quot;, current value &quot;</span> + std::to_string(curValue);</div><div class="line">    menuPpParams.push_back(nvpParam);</div><div class="line">}</div><div class="line"><span class="keywordflow">if</span> (!GetMenuSelection(<span class="stringliteral">&quot;Choose Post-Processing Parameter&quot;</span>,</div><div class="line">            menuPpParams, menuSelection))</div><div class="line">{</div><div class="line">    printf(<span class="stringliteral">&quot;No valid Parameter selected, exiting...\n&quot;</span>);</div><div class="line">    <span class="keywordflow">break</span>; <span class="comment">// Not an error, exit the app</span></div><div class="line">}</div><div class="line"><span class="keyword">const</span> PvcamPpParameter&amp; ppParam = ppFeature.parameterList[menuSelection];</div></div><!-- fragment --><p>Once the PP feature and PP parameter indexes are retrieved from the user, ask the user to enter a new value for this particular PP parameter. Once obtained, set the new value with the <a class="el" href="_ex__common_functions.xhtml#SetPpParamValue">SetPpParamValue</a> helper function and verify it by reading back the value with the <a class="el" href="_ex__common_functions.xhtml#GetPpParamValue">GetPpParamValue</a> function.</p>
<p>Clean up before exiting the application. For more details, please, refer to the <a class="el" href="_ex__common_functions.xhtml#secExUninit">Closing Camera and Uninitializing PVCAM</a> section. </p><div class="fragment"><div class="line">CloseCameraAndUninit();</div><div class="line"><span class="keywordflow">return</span> 0;</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="_example_guides.xhtml">Code Example Guides</a></li>
    <li class="footer">
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a></li>
  </ul>
</div>
</body>
</html>
